@page "/components/dynamic-form"

<PageTitle>DynamicForm Component - Blazor Blueprint</PageTitle>

<div class="space-y-8 max-w-4xl">
    <div>
        <div class="space-y-3">
            <h1 class="text-4xl font-bold tracking-tight">DynamicForm</h1>
            <p class="text-xl text-muted-foreground">
                Render forms from schema definitions. Eliminates hand-coding forms for CMS, admin panels,
                and settings pages where form structure comes from backend configuration.
            </p>
        </div>
    </div>

    <!-- Basic Form -->
    <div class="space-y-4">
        <div class="space-y-2">
            <h2 class="text-2xl font-semibold">Basic Dynamic Form</h2>
            <p class="text-sm text-muted-foreground">
                Define a schema with field definitions and the form renders the correct input component for each field type.
            </p>
        </div>
        <div class="max-w-lg">
            <BbDynamicForm Schema="@_basicSchema"
                           @bind-Values="_basicValues"
                           OnValidSubmit="HandleBasicSubmit" />
        </div>
        <div class="rounded-lg border p-4 bg-muted/50">
            <p class="text-sm font-medium mb-1">Current values:</p>
            <pre class="text-sm font-mono whitespace-pre-wrap">@FormatValues(_basicValues)</pre>
        </div>
        <CodeBlock Source="Components/DynamicForm/basic.txt" />
    </div>

    <!-- Multi-Section Form -->
    <div class="space-y-4">
        <div class="space-y-2">
            <h2 class="text-2xl font-semibold">Multi-Section Form</h2>
            <p class="text-sm text-muted-foreground">
                Group related fields into sections with headings, descriptions, and optional collapsible behavior.
            </p>
        </div>
        <div class="max-w-2xl">
            <BbDynamicForm Schema="@_sectionSchema"
                           @bind-Values="_sectionValues"
                           OnValidSubmit="HandleSectionSubmit" />
        </div>
        <div class="rounded-lg border p-4 bg-muted/50">
            <p class="text-sm font-medium mb-1">Current values:</p>
            <pre class="text-sm font-mono whitespace-pre-wrap">@FormatValues(_sectionValues)</pre>
        </div>
        <CodeBlock Source="Components/DynamicForm/multi-section.txt" />
    </div>

    <!-- Conditional Visibility -->
    <div class="space-y-4">
        <div class="space-y-2">
            <h2 class="text-2xl font-semibold">Conditional Visibility</h2>
            <p class="text-sm text-muted-foreground">
                Show or hide fields based on other field values using <code class="text-xs bg-muted px-1 py-0.5 rounded">VisibleWhen</code> expressions.
                Select "US" as the country to reveal the State field.
            </p>
        </div>
        <div class="max-w-lg">
            <BbDynamicForm Schema="@_conditionalSchema"
                           @bind-Values="_conditionalValues"
                           OnValidSubmit="HandleConditionalSubmit" />
        </div>
        <div class="rounded-lg border p-4 bg-muted/50">
            <p class="text-sm font-medium mb-1">Current values:</p>
            <pre class="text-sm font-mono whitespace-pre-wrap">@FormatValues(_conditionalValues)</pre>
        </div>
        <CodeBlock Source="Components/DynamicForm/conditional-visibility.txt" />
    </div>

    <!-- Multi-Column Layout -->
    <div class="space-y-4">
        <div class="space-y-2">
            <h2 class="text-2xl font-semibold">Multi-Column Layout</h2>
            <p class="text-sm text-muted-foreground">
                Use the <code class="text-xs bg-muted px-1 py-0.5 rounded">Columns</code> parameter for responsive grid layouts.
                Fields can span multiple columns with <code class="text-xs bg-muted px-1 py-0.5 rounded">ColSpan</code>.
            </p>
        </div>
        <BbDynamicForm Schema="@_multiColSchema"
                       @bind-Values="_multiColValues"
                       Columns="2"
                       OnValidSubmit="HandleMultiColSubmit" />
        <div class="rounded-lg border p-4 bg-muted/50">
            <p class="text-sm font-medium mb-1">Current values:</p>
            <pre class="text-sm font-mono whitespace-pre-wrap">@FormatValues(_multiColValues)</pre>
        </div>
        <CodeBlock Source="Components/DynamicForm/multi-column.txt" />
    </div>

    <!-- JSON Schema -->
    <div class="space-y-4">
        <div class="space-y-2">
            <h2 class="text-2xl font-semibold">JSON Schema-Driven Form</h2>
            <p class="text-sm text-muted-foreground">
                Parse a JSON Schema string into a form definition using <code class="text-xs bg-muted px-1 py-0.5 rounded">FormSchemaParser.FromJson</code>.
                Useful for API-driven forms where the schema comes from the server.
            </p>
        </div>
        <div class="max-w-lg">
            <BbDynamicForm Schema="@_jsonSchema"
                           @bind-Values="_jsonValues"
                           OnValidSubmit="HandleJsonSubmit" />
        </div>
        <div class="rounded-lg border p-4 bg-muted/50">
            <p class="text-sm font-medium mb-1">Current values:</p>
            <pre class="text-sm font-mono whitespace-pre-wrap">@FormatValues(_jsonValues)</pre>
        </div>
        <CodeBlock Source="Components/DynamicForm/json-schema.txt" />
    </div>

    <!-- Read-Only / Disabled -->
    <div class="space-y-4">
        <div class="space-y-2">
            <h2 class="text-2xl font-semibold">Read-Only / Disabled</h2>
            <p class="text-sm text-muted-foreground">
                Use <code class="text-xs bg-muted px-1 py-0.5 rounded">Disabled</code> to prevent all interaction.
            </p>
        </div>
        <div class="max-w-lg">
            <BbDynamicForm Schema="@_basicSchema"
                           @bind-Values="_disabledValues"
                           Disabled="true"
                           ShowSubmitButton="false" />
        </div>
        <CodeBlock Source="Components/DynamicForm/read-only-disabled.txt" />
    </div>

    <!-- Validation -->
    <div class="space-y-4">
        <div class="space-y-2">
            <h2 class="text-2xl font-semibold">Validation</h2>
            <p class="text-sm text-muted-foreground">
                Define validation rules on field definitions. Required fields, patterns, min/max length,
                and numeric range validations are all supported. Try submitting the empty form.
            </p>
        </div>
        <div class="max-w-lg">
            <BbDynamicForm Schema="@_validationSchema"
                           @bind-Values="_validationValues"
                           OnValidSubmit="HandleValidationSubmit" />
        </div>
        <CodeBlock Source="Components/DynamicForm/validation.txt" />
    </div>

    @if (!string.IsNullOrEmpty(_submitMessage))
    {
        <BbAlert Variant="AlertVariant.Success" Dismissible="true" OnDismiss="() => _submitMessage = null">
            <BbAlertTitle>Form Submitted</BbAlertTitle>
            <BbAlertDescription>@_submitMessage</BbAlertDescription>
        </BbAlert>
    }

    <!-- Accessibility -->
    <AccessibilityList>
        <AriaAttributes>
            <AccessibilityItem>
                Each rendered input inherits the accessibility features of its underlying BlazorBlueprint component (labels, ARIA attributes, error announcements)
            </AccessibilityItem>
            <AccessibilityItem>
                Labels are automatically associated with their inputs via <code class="text-xs bg-muted px-1 py-0.5 rounded">BbFieldLabel</code>
            </AccessibilityItem>
            <AccessibilityItem>
                Validation errors are displayed inline with <code class="text-xs bg-muted px-1 py-0.5 rounded">BbFieldError</code> for screen reader support
            </AccessibilityItem>
            <AccessibilityItem>
                Hidden fields (via <code class="text-xs bg-muted px-1 py-0.5 rounded">VisibleWhen</code>) are fully removed from the DOM, not just visually hidden
            </AccessibilityItem>
            <AccessibilityItem>
                Collapsible sections use <code class="text-xs bg-muted px-1 py-0.5 rounded">BbCollapsible</code> with proper <code class="text-xs bg-muted px-1 py-0.5 rounded">aria-expanded</code> state
            </AccessibilityItem>
            <AccessibilityItem>
                Form uses native <code class="text-xs bg-muted px-1 py-0.5 rounded">&lt;form&gt;</code> element for standard submit behavior
            </AccessibilityItem>
        </AriaAttributes>
        <KeyboardNavigation>
            <KeyboardShortcutItem Description="Move between form fields">
                <BbKbd>Tab</BbKbd>
            </KeyboardShortcutItem>
            <KeyboardShortcutItem Description="Submit the form">
                <BbKbd>Enter</BbKbd>
            </KeyboardShortcutItem>
            <KeyboardShortcutItem Description="Toggle collapsible sections">
                <BbKbd>Enter</BbKbd> or <BbKbd>Space</BbKbd>
            </KeyboardShortcutItem>
        </KeyboardNavigation>
    </AccessibilityList>

    <!-- API Reference -->
    <section class="space-y-4">
        <div class="space-y-2">
            <h2 class="text-2xl font-semibold">API Reference</h2>
            <p class="text-muted-foreground">Component properties and parameters.</p>
        </div>

        <div class="space-y-4">
            <ApiReference ComponentName="BbDynamicForm">
                <ApiParameter Name="Schema" Type="FormSchema?">
                    The schema definition for the form, containing fields and/or sections.
                </ApiParameter>
                <ApiParameter Name="Values" Type="Dictionary&lt;string, object?&gt;">
                    The current form values dictionary. Use <code>@@bind-Values</code> for two-way binding.
                </ApiParameter>
                <ApiParameter Name="OnSubmit" Type="EventCallback&lt;Dictionary&lt;string, object?&gt;&gt;">
                    Callback invoked on form submission regardless of validation.
                </ApiParameter>
                <ApiParameter Name="OnValidSubmit" Type="EventCallback&lt;Dictionary&lt;string, object?&gt;&gt;">
                    Callback invoked on form submission only when all validation passes.
                </ApiParameter>
                <ApiParameter Name="OnFieldChanged" Type="EventCallback&lt;FormFieldChangedEventArgs&gt;">
                    Callback invoked when any field value changes. Provides field name, old value, and new value.
                </ApiParameter>
                <ApiParameter Name="Layout" Type="FormLayout" Default="Vertical">
                    Form layout mode. Options: Vertical, Horizontal, Inline.
                </ApiParameter>
                <ApiParameter Name="Columns" Type="int" Default="1">
                    Number of columns for the responsive grid layout. Can be overridden per section.
                </ApiParameter>
                <ApiParameter Name="ReadOnly" Type="bool" Default="false">
                    Whether all fields are rendered as read-only.
                </ApiParameter>
                <ApiParameter Name="Disabled" Type="bool" Default="false">
                    Whether all fields are disabled.
                </ApiParameter>
                <ApiParameter Name="SubmitText" Type="string" Default="Submit">
                    Text for the built-in submit button.
                </ApiParameter>
                <ApiParameter Name="ShowSubmitButton" Type="bool" Default="true">
                    Whether to show the built-in submit button.
                </ApiParameter>
                <ApiParameter Name="ShowValidationSummary" Type="bool" Default="false">
                    Whether to show a validation error summary at the top of the form. When false, errors are only shown inline next to each field.
                </ApiParameter>
                <ApiParameter Name="Class" Type="string?" Default="null">
                    Additional CSS classes applied to the form element.
                </ApiParameter>
                <ApiParameter Name="FieldRenderers" Type="Dictionary&lt;string, RenderFragment&lt;DynamicFieldRenderContext&gt;&gt;?">
                    Custom field renderers keyed by field name. Used for <code>FieldType.Custom</code> fields.
                </ApiParameter>
                <ApiParameter Name="ChildContent" Type="RenderFragment?">
                    Additional content rendered inside the form (e.g., extra buttons).
                </ApiParameter>
            </ApiReference>

            <ApiReference ComponentName="FormSchema">
                <ApiParameter Name="Title" Type="string?">
                    Form title displayed above the form.
                </ApiParameter>
                <ApiParameter Name="Description" Type="string?">
                    Description displayed below the title.
                </ApiParameter>
                <ApiParameter Name="Fields" Type="List&lt;FormFieldDefinition&gt;">
                    Flat list of fields. Ignored when Sections is populated.
                </ApiParameter>
                <ApiParameter Name="Sections" Type="List&lt;FormSectionDefinition&gt;">
                    Grouped fields with headings and descriptions. When set, Fields is ignored.
                </ApiParameter>
                <ApiParameter Name="Columns" Type="int" Default="1">
                    Default number of grid columns. Individual sections can override this.
                </ApiParameter>
            </ApiReference>

            <ApiReference ComponentName="FormFieldDefinition">
                <ApiParameter Name="Name" Type="string">
                    Field name used as the key in the values dictionary.
                </ApiParameter>
                <ApiParameter Name="Label" Type="string?">
                    Label text displayed above or beside the field.
                </ApiParameter>
                <ApiParameter Name="Description" Type="string?">
                    Helper text displayed below the field.
                </ApiParameter>
                <ApiParameter Name="Placeholder" Type="string?">
                    Placeholder text displayed when the field is empty.
                </ApiParameter>
                <ApiParameter Name="Type" Type="FieldType" Default="Text">
                    Field type that determines which component is rendered. Options: Text, Email, Password, Url, Phone, Number, Currency, Textarea, RichText, Select, Combobox, MultiSelect, NativeSelect, Checkbox, Switch, CheckboxGroup, RadioGroup, Date, DateRange, Time, DateTime, Color, File, OTP, Slider, RangeSlider, Tags, Custom.
                </ApiParameter>
                <ApiParameter Name="Required" Type="bool" Default="false">
                    Whether this field is required.
                </ApiParameter>
                <ApiParameter Name="Disabled" Type="bool" Default="false">
                    Whether this field is disabled.
                </ApiParameter>
                <ApiParameter Name="ReadOnly" Type="bool" Default="false">
                    Whether this field is read-only.
                </ApiParameter>
                <ApiParameter Name="DefaultValue" Type="object?">
                    Default value applied when the field is not present in the values dictionary.
                </ApiParameter>
                <ApiParameter Name="Order" Type="int?">
                    Display order. Fields with lower values appear first. Null uses definition order.
                </ApiParameter>
                <ApiParameter Name="ColSpan" Type="int" Default="1">
                    Number of grid columns this field spans.
                </ApiParameter>
                <ApiParameter Name="VisibleWhen" Type="string?">
                    Visibility expression evaluated against current values. Example: <code>"Country == 'US'"</code>. Supports <code>==</code>, <code>!=</code>, <code>&amp;&amp;</code>, <code>||</code>, <code>!</code>.
                </ApiParameter>
                <ApiParameter Name="Options" Type="List&lt;SelectOption&lt;string&gt;&gt;?">
                    Options for Select, Combobox, MultiSelect, RadioGroup, and CheckboxGroup fields.
                </ApiParameter>
                <ApiParameter Name="Validations" Type="List&lt;FieldValidation&gt;?">
                    Validation rules for this field.
                </ApiParameter>
                <ApiParameter Name="Metadata" Type="Dictionary&lt;string, object&gt;?">
                    Additional metadata for field-type-specific configuration (e.g., min, max, step for sliders).
                </ApiParameter>
            </ApiReference>

            <ApiReference ComponentName="FormSectionDefinition">
                <ApiParameter Name="Title" Type="string?">
                    Section heading text.
                </ApiParameter>
                <ApiParameter Name="Description" Type="string?">
                    Section description displayed below the heading.
                </ApiParameter>
                <ApiParameter Name="Fields" Type="List&lt;FormFieldDefinition&gt;">
                    Fields within this section.
                </ApiParameter>
                <ApiParameter Name="Columns" Type="int?">
                    Override for the form-level column count within this section.
                </ApiParameter>
                <ApiParameter Name="VisibleWhen" Type="string?">
                    Visibility expression that controls whether this section is shown.
                </ApiParameter>
                <ApiParameter Name="Collapsible" Type="bool" Default="false">
                    Whether this section can be collapsed.
                </ApiParameter>
                <ApiParameter Name="DefaultExpanded" Type="bool" Default="true">
                    Whether this section is initially expanded when Collapsible is true.
                </ApiParameter>
            </ApiReference>

            <ApiReference ComponentName="FieldValidation">
                <ApiParameter Name="Type" Type="ValidationType">
                    Validation type. Options: Required, MinLength, MaxLength, Min, Max, Pattern, Email, Url, Phone, Custom.
                </ApiParameter>
                <ApiParameter Name="Value" Type="object?">
                    Validation parameter (e.g., max length number, regex pattern string).
                </ApiParameter>
                <ApiParameter Name="Message" Type="string?">
                    Custom error message. When null, a default message is generated.
                </ApiParameter>
            </ApiReference>
        </div>
    </section>
</div>

@code {
    private string? _submitMessage;

    // ── Basic Form ──────────────────────────────────────────────────

    private readonly FormSchema _basicSchema = new()
    {
        Title = "Contact Information",
        Description = "Enter your basic contact details.",
        Fields =
        [
            new FormFieldDefinition { Name = "FirstName", Label = "First Name", Type = FieldType.Text, Placeholder = "John", Required = true },
            new FormFieldDefinition { Name = "LastName", Label = "Last Name", Type = FieldType.Text, Placeholder = "Doe", Required = true },
            new FormFieldDefinition { Name = "Email", Label = "Email Address", Type = FieldType.Email, Placeholder = "john@example.com", Required = true },
            new FormFieldDefinition { Name = "Theme", Label = "Preferred Theme", Type = FieldType.Select, Options = [new("light", "Light"), new("dark", "Dark"), new("system", "System")] },
            new FormFieldDefinition { Name = "Newsletter", Label = "Subscribe to newsletter", Type = FieldType.Switch }
        ]
    };

    private Dictionary<string, object?> _basicValues = new();

    // ── Section Form ────────────────────────────────────────────────

    private readonly FormSchema _sectionSchema = new()
    {
        Title = "User Registration",
        Sections =
        [
            new FormSectionDefinition
            {
                Title = "Personal Details",
                Description = "Your basic information.",
                Fields =
                [
                    new FormFieldDefinition { Name = "FullName", Label = "Full Name", Type = FieldType.Text, Required = true },
                    new FormFieldDefinition { Name = "Email", Label = "Email", Type = FieldType.Email, Required = true },
                    new FormFieldDefinition { Name = "Phone", Label = "Phone", Type = FieldType.Phone, Placeholder = "+1 (555) 000-0000" }
                ]
            },
            new FormSectionDefinition
            {
                Title = "Preferences",
                Description = "Customize your experience.",
                Collapsible = true,
                Fields =
                [
                    new FormFieldDefinition { Name = "Language", Label = "Language", Type = FieldType.Select, Options = [new("en", "English"), new("es", "Spanish"), new("fr", "French"), new("de", "German")] },
                    new FormFieldDefinition { Name = "DarkMode", Label = "Dark Mode", Type = FieldType.Switch },
                    new FormFieldDefinition { Name = "Notifications", Label = "Notification Preferences", Type = FieldType.CheckboxGroup, Options = [new("email", "Email"), new("sms", "SMS"), new("push", "Push")] }
                ]
            }
        ]
    };

    private Dictionary<string, object?> _sectionValues = new();

    // ── Conditional Visibility ──────────────────────────────────────

    private readonly FormSchema _conditionalSchema = new()
    {
        Fields =
        [
            new FormFieldDefinition
            {
                Name = "Country", Label = "Country", Type = FieldType.Select, Required = true,
                Options = [new("US", "United States"), new("CA", "Canada"), new("UK", "United Kingdom"), new("AU", "Australia")]
            },
            new FormFieldDefinition
            {
                Name = "State", Label = "State", Type = FieldType.Select,
                VisibleWhen = "Country == 'US'",
                Options = [new("CA", "California"), new("NY", "New York"), new("TX", "Texas"), new("FL", "Florida")]
            },
            new FormFieldDefinition
            {
                Name = "Province", Label = "Province", Type = FieldType.Select,
                VisibleWhen = "Country == 'CA'",
                Options = [new("ON", "Ontario"), new("QC", "Quebec"), new("BC", "British Columbia")]
            },
            new FormFieldDefinition
            {
                Name = "PostalCode", Label = "Postal Code", Type = FieldType.Text,
                VisibleWhen = "Country != null",
                Placeholder = "Enter postal code"
            }
        ]
    };

    private Dictionary<string, object?> _conditionalValues = new();

    // ── Multi-Column ────────────────────────────────────────────────

    private readonly FormSchema _multiColSchema = new()
    {
        Title = "Shipping Address",
        Columns = 2,
        Fields =
        [
            new FormFieldDefinition { Name = "FirstName", Label = "First Name", Type = FieldType.Text, Required = true },
            new FormFieldDefinition { Name = "LastName", Label = "Last Name", Type = FieldType.Text, Required = true },
            new FormFieldDefinition { Name = "Address", Label = "Street Address", Type = FieldType.Text, ColSpan = 2, Required = true },
            new FormFieldDefinition { Name = "City", Label = "City", Type = FieldType.Text, Required = true },
            new FormFieldDefinition { Name = "Zip", Label = "ZIP Code", Type = FieldType.Text },
            new FormFieldDefinition { Name = "Notes", Label = "Delivery Notes", Type = FieldType.Textarea, ColSpan = 2, Placeholder = "Any special instructions..." }
        ]
    };

    private Dictionary<string, object?> _multiColValues = new();

    // ── JSON Schema ─────────────────────────────────────────────────

    private static readonly string _jsonSchemaString = @"{
        ""type"": ""object"",
        ""title"": ""Product Feedback"",
        ""description"": ""Help us improve by sharing your feedback."",
        ""required"": [""name"", ""rating""],
        ""properties"": {
            ""name"": {
                ""type"": ""string"",
                ""title"": ""Your Name"",
                ""minLength"": 2,
                ""maxLength"": 100
            },
            ""email"": {
                ""type"": ""string"",
                ""format"": ""email"",
                ""title"": ""Email Address""
            },
            ""rating"": {
                ""type"": ""integer"",
                ""title"": ""Rating (1-5)"",
                ""minimum"": 1,
                ""maximum"": 5
            },
            ""category"": {
                ""type"": ""string"",
                ""title"": ""Category"",
                ""enum"": [""bug"", ""feature"", ""improvement"", ""question""]
            },
            ""comments"": {
                ""type"": ""string"",
                ""title"": ""Comments"",
                ""maxLength"": 500
            }
        }
    }";

    private readonly FormSchema _jsonSchema = FormSchemaParser.FromJson(_jsonSchemaString);

    private Dictionary<string, object?> _jsonValues = new();

    // ── Disabled ────────────────────────────────────────────────────

    private Dictionary<string, object?> _disabledValues = new()
    {
        ["FirstName"] = "John",
        ["LastName"] = "Doe",
        ["Email"] = "john@example.com",
        ["Theme"] = "dark",
        ["Newsletter"] = true
    };

    // ── Validation ──────────────────────────────────────────────────

    private readonly FormSchema _validationSchema = new()
    {
        Title = "Account Setup",
        Fields =
        [
            new FormFieldDefinition
            {
                Name = "Username", Label = "Username", Type = FieldType.Text, Required = true,
                Validations = [new() { Type = ValidationType.MinLength, Value = 3, Message = "Username must be at least 3 characters." }, new() { Type = ValidationType.MaxLength, Value = 20 }]
            },
            new FormFieldDefinition
            {
                Name = "Email", Label = "Email", Type = FieldType.Email, Required = true,
                Validations = [new() { Type = ValidationType.Email }]
            },
            new FormFieldDefinition
            {
                Name = "Password", Label = "Password", Type = FieldType.Password, Required = true,
                Validations = [new() { Type = ValidationType.MinLength, Value = 8, Message = "Password must be at least 8 characters." }, new() { Type = ValidationType.Pattern, Value = @"(?=.*[A-Z])(?=.*\d)", Message = "Password must contain at least one uppercase letter and one digit." }]
            },
            new FormFieldDefinition
            {
                Name = "Age", Label = "Age", Type = FieldType.Number,
                Validations = [new() { Type = ValidationType.Min, Value = 18, Message = "You must be at least 18 years old." }, new() { Type = ValidationType.Max, Value = 120 }]
            },
            new FormFieldDefinition
            {
                Name = "Website", Label = "Website (optional)", Type = FieldType.Url,
                Validations = [new() { Type = ValidationType.Url }]
            }
        ]
    };

    private Dictionary<string, object?> _validationValues = new();

    // ── Handlers ────────────────────────────────────────────────────

    private void HandleBasicSubmit(Dictionary<string, object?> values)
    {
        _submitMessage = $"Basic form submitted with {values.Count} fields.";
    }

    private void HandleSectionSubmit(Dictionary<string, object?> values)
    {
        _submitMessage = $"Registration form submitted with {values.Count} fields.";
    }

    private void HandleConditionalSubmit(Dictionary<string, object?> values)
    {
        _submitMessage = $"Location form submitted. Country: {values.GetValueOrDefault("Country")}";
    }

    private void HandleMultiColSubmit(Dictionary<string, object?> values)
    {
        _submitMessage = $"Shipping form submitted for {values.GetValueOrDefault("FirstName")} {values.GetValueOrDefault("LastName")}.";
    }

    private void HandleJsonSubmit(Dictionary<string, object?> values)
    {
        _submitMessage = $"Feedback form submitted. Rating: {values.GetValueOrDefault("rating")}";
    }

    private void HandleValidationSubmit(Dictionary<string, object?> values)
    {
        _submitMessage = $"Account created for {values.GetValueOrDefault("Username")}!";
    }

    private static string FormatValues(Dictionary<string, object?> values)
    {
        if (values.Count == 0)
        {
            return "(no values yet)";
        }

        return string.Join("\n", values.Select(kv => $"{kv.Key}: {kv.Value ?? "(null)"}"));
    }
}
